# –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π REST API

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Spring Boot —Å JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.
---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å—Ç–µ–∫–∞:**
   ```bash
   docker compose up --build
   ```
   - –ó–∞–ø—É—Å—Ç–∏—Ç PostgreSQL –∏ Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
   - API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8080`
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ `localhost:5432` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `postgres`, –ø–∞—Ä–æ–ª—å: `postgres`, –ë–î: `postgres`).
   - –°—Ö–µ–º–∞ –±–∞–∑—ã –∏ –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `src/main/resources/sql/schema.sql` –∏ `data.sql`.

2. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–µ–∫–∞:**
   ```bash
   docker compose down
   ```
   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏ —É–¥–∞–ª–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Docker volume `db_data`, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–∏—Ç—å –µ–≥–æ —è–≤–Ω–æ: `docker volume rm finance_db_data`.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL** (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω).
2. **–°–æ–∑–¥–∞–π—Ç–µ —Å—Ö–µ–º—É –±–∞–∑—ã –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
   - –°–º. —Ä–∞–∑–¥–µ–ª [–°–æ–∑–¥–∞–Ω–∏–µ SQL-—Ç–∞–±–ª–∏—Ü](#—Å–æ–∑–¥–∞–Ω–∏–µ-sql-—Ç–∞–±–ª–∏—Ü) –Ω–∏–∂–µ –¥–ª—è –∫–æ–º–∞–Ω–¥.
   - –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ `src/main/resources/sql/schema.sql` –∏ `data.sql`.
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   ./mvnw spring-boot:run
   ```
4. **–î–æ—Å—Ç—É–ø –∫ API:**
   - `http://localhost:8080`

---

## üìù –°–æ–∑–¥–∞–Ω–∏–µ SQL-—Ç–∞–±–ª–∏—Ü

–ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã –≤ PostgreSQL —Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏:

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(50) NOT NULL UNIQUE,
  password VARCHAR(100) NOT NULL,
  roles VARCHAR(100) NOT NULL DEFAULT 'ROLE_USER',
  full_name VARCHAR(100) NOT NULL,
  balance NUMERIC(19,2) NOT NULL DEFAULT 0.00
);

CREATE TABLE transactions (
  id SERIAL PRIMARY KEY,
  user_id INT NOT NULL REFERENCES users(id),
  amount NUMERIC(19,2) NOT NULL,
  type VARCHAR(10) NOT NULL, -- CREDIT –∏–ª–∏ DEBIT
  timestamp TIMESTAMP WITHOUT TIME ZONE NOT NULL DEFAULT NOW(),
  description VARCHAR(255)
);
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã `src/main/resources/sql/schema.sql` –∏ `data.sql` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

### –ü–æ—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

1. **–í—Ö–æ–¥**: `POST /api/auth/login` —Å username –∏ password
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞**: —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è JWT
3. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤**: –ø–µ—Ä–µ–¥–∞—ë–º —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: JWT-—Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/auth/login` ‚Äî –≤—Ö–æ–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∑–∞—â–∏—â—ë–Ω–Ω—ã–µ)
- `GET /api/users` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/users/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- `POST /api/users` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/users/{id}` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∑–∞—â–∏—â—ë–Ω–Ω—ã–µ)
- `GET /api/transactions` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `GET /api/transactions/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ ID
- `POST /api/transactions` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### JWT-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```yaml
jwt:
  secret: y7K8s0Pq2X9Rv4HdU5Jm1Zt3Wq6Ne8B4
  expiration-ms: 3600000  # 1 —á–∞—Å
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/postgres
    username: postgres
    password: postgres
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Docker
–°–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ `docker-compose.yml`:

- `POSTGRES_DB`: –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: finance)
- `POSTGRES_USER`: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: postgres)
- `POSTGRES_PASSWORD`: –ø–∞—Ä–æ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: postgres)
- `JWT_SECRET`: —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: y7K8s0Pq2X9Rv4HdU5Jm1Zt3Wq6Ne8B4)
- `JWT_EXPIRATION_MS`: –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ JWT –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3600000)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í—Ö–æ–¥
```bash
curl -X POST http://localhost:8080/api/auth/login   -H "Content-Type: application/json"   -d '{"username":"boss","password":"testpass"}'
```

### –î–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É
```bash
curl -H "Authorization: Bearer <your-jwt-token>"   http://localhost:8080/api/users
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í –±–∞–∑–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- Username: `testuser`, Password: `testpass`
- Username: `alice`, Password: (`password`)
- Username: `bob`, Password: (`password`)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Spring Boot 3.5.4
- Spring Security
- Spring Data JPA
- PostgreSQL
- JWT (jjwt)
- Lombok  
